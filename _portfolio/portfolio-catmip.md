---
title: "CATMiP: Cooperative and Asynchronous Transformer-based Mission Planning for Heterogeneous Teams of Mobile Robots"
excerpt: "The CATMiP framework in the distributed execution phase.<br/><img src='/images/CATMiP(Distributed).png'>"
collection: portfolio
---

## Framework
CATMiP follows the centralized training and decentralized execution (CTDE) principle and consists of several key modules: the *Asynchronous Multi-Agent Transformer (AMAT)*, *Collaborative Simultaneous Localization and Mapping (CSLAM)*, the *High-Level Processor*, and the *Low-Level Navigation Controller*.
These modules are implemented and utilized differently during the training and execution phases.

Figure 1 (a) depicts the CATMiP architecture and data flow at time-step $t$ of a simulated training episode with full communication, where the *active* subset $i_{1:g}$ of the agents are obtaining new macro-actions (MAs). During mission execution, each agent generates MAs individually or together with other active agents in its communication neighborhood, as shown in Figure 1 (b).

At each time-step of the mission, agents are considered as active, inactive, or on standby. Inactive agents continue executing primitive actions generated by their current MA, but enter standby mode when their MA termination condition is met. Agents on standby remain at their current location, waiting a random number of time-steps to find other on-standby agents in their communication neighborhood in order to activate at the same time-step together and obtain their new MAs with one pass through the network. If an agent's maximum standby time is reached and no other on-standby agent was found in the neighborhood, it activates alone. Agents that update their MAs become inactive again.

![CATMiP in centralized training and distributed execution phases](/images/CATMiP.png "Figure 1 - (a) The centralized training workflow of the CATMiP framework in a simulated mission episode. (b) Implementation of the CATMiP framework on a single robot during the execution phase, where robots share mapping information and their embedded macro-observations to generate new actions in a distributed way.")

### Asynchronous Multi-Agent Transformer

The asynchronous multi-agent transformer (AMAT) module, illustrated in Figure 2, consists of four components: the macro-observations embedder, the encoder, the macro-actions embedder, and the decoder. In summary, AMAT processes a sequence of macro-observations from agents $i_{1:m}$, accompanied by a vector of active flags indicating the subset $i_{1:g}$ ($g \le m$) of these agents requiring new macro-actions. It then outputs the corresponding sequence of macro-actions. The input and output sequence lengths are flexible, allowing AMAT to model policies for a variable number of agents within a single network, and to support asynchronous training and inference.

During centralized training, $i_{1:m}$ represents the complete agent set $I=\{1,\dots,N\}$, while in the distributed execution phase, it denotes the set of agents in the same neighborhood $\mathcal{N}(i)=\{i_1,\dots,i_m\}$. In both cases, the sets are ordered to put the active agents $i_{1:g}$ first.

![Centralized training of AMAT](/images/AMAT(Centralized).png "Figure 2 - Centralized macro-action inference as a part of the training process of AMAT. During distributed execution, the broker robot receives macro-observation embeddings from connected agents and transmits the newly obtained MAs back to them.")

## Simulation Results
<img src="/images/catmip_simulation.gif" width="330" height="330" />

[See the code here](https://github.com/mylad13/CATMiP)
The preprint is now published on [arXiv!](https://arxiv.org/abs/2410.06372)